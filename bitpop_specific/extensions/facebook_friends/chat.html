<!DOCTYPE HTML>
<html>
<head>
  <link rel="stylesheet" href="css/chat_popup.css" type="text/css" media="screen" charset="utf-8">
  <link rel="stylesheet" href="css/antiscroll.css" type="text/css" media="screen" charset="utf-8">
  <script src='js/jquery.min.js'></script>
  <script src="js/autolink-min.js"></script>
  <script src="js/jquery-mousewheel.js"></script>
  <script src="js/antiscroll.js"></script>
  <script src="js/common.js"></script>
  <script src="js/chat_popup.js"></script>
  <script type="text/javascript">
    if (location.search !== "?foo") {
      location.search = "?foo";
      throw new Error;  // load everything on the next page;
                            // stop execution on this page
    }

    $(function() {
        bitpop.chat.init();

        $('.box-wrap').antiscroll();

        function setUserNameCallback(uname) {
          $('.content-friend-name').text(uname);
        }

        function setHeadURL(profile_url) {
          $('#head').click(function() { chrome.tabs.create({ url: profile_url }); });
        }

        chrome.extension.sendRequest(bitpop.CONTROLLER_EXTENSION_ID,
          { type: 'getFBUserNameByUid',
            uid: window.location.hash.substr(1).split('&')[0] },
          function (response) {
            setUserNameCallback(response.uname);
            setHeadURL(response.profile_url);
          }
        );
    });
  </script>
</head>
<body>
  <div id="head" class="content-friend-name">
  </div>
  <div class="box-wrap antiscroll-wrap">
    <div class="box">
      <div class="antiscroll-inner">
        <div class="box-inner" id="chat">
          <div class="composing-notification"><span
              class="content-friend-name"></span> is typing...
          </div>
        </div>
      </div>
    </div>
  </div>

  <form id="msgForm">
    <input type="text" id="msg" autofocus />
    <input id="pastePageLink" type="button" value="" />
    <input type="submit" style="visibility:hidden; height: 0" />
  </form>
</body>
</html>
